# Connected Spaces Platform Wrapper Generator

This subproject of CSP contains the **Wrapper Generator** responsible for generating interop code for client languages.

```
usage: WrapperGenerator.py [-h] [--generate_csharp] [--generate_typescript] [--no_generate_c] [--include_directory INCLUDE_DIRECTORY]

options:
  -h, --help            show this help message and exit
  --generate_csharp
  --generate_typescript
  --no_generate_c
  --include_directory INCLUDE_DIRECTORY
  ```

Output is written to the `Output/` directory.

## Parser

The parser is written in Python as a [recursive descent parser]. It parses the very specific subset of C++ used by the CSP library headers and outputs metadata types (defined in [MetadataTypes.py](./MetadataTypes.py)).

Documentation comments (in Doxygen style) are parsed and added to the type metadata.

## Generators

The wrapper generator currently generates an interop layer for:

* [C](./CWrapperGenerator.py)
* [Typescript/Javascript](./TypeScriptWrapperGenerator.py) (with [WebAssembly] interop)
* [C#](./CSharpWrapperGenerator.py)

The Typescript and C# wrappers rely on the C wrapper, which is always generated by default.

Each wrapper generator is responsible for taking the generic metadata types output from the Parser, translating them into the appropriate concepts and naming conventions for the target language and invoking code generation.

Code generation is implemented using the [Mustache] templating language, through the [Chevron] implementation in Python.

Each generator then runs the resulting code through a code prettifier.

## Tests

Some (currently limited) unit tests are in [tests](./tests/).
Unit tests should be written using [unittest] and test coverage may be measured using [coverage].

A suite of integration tests is available in the [UnitTesting](../../UnitTesting/README.md) directory.

[Chevron]: https://github.com/noahmorrison/chevron
[coverage]: https://coverage.readthedocs.io/
[Mustache]: https://mustache.github.io/mustache.5.html
[recursive descent parser]: https://en.wikipedia.org/wiki/Recursive_descent_parser
[unittest]: https://docs.python.org/3/library/unittest.html
[WebAssembly]: https://webassembly.org/